<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <title>Court Data Fetcher - Case Details</title>
  <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet" />
</head>
<body class="container mt-4">

  {% with messages = get_flashed_messages(with_categories=true) %}
    {% if messages %}
      {% for category, message in messages %}
        <div class="alert alert-{{ category }} alert-dismissible fade show" role="alert">
          {{ message }}
          <button type="button" class="btn-close" data-bs-dismiss="alert" aria-label="Close"></button>
        </div>
      {% endfor %}
    {% endif %}
  {% endwith %}

  <h1 class="mb-4">Case Details</h1>

  <table class="table table-bordered">
    <tbody>
      <tr><th>Court Type</th><td>{{ details.court_type }}</td></tr>
      <tr><th>Case Type</th><td>{{ details.case_type }}</td></tr>
      <tr><th>Filing Number</th><td>{{ details.filing_number }}</td></tr>
      <tr><th>Filing Date</th><td>{{ details.filing_date }}</td></tr>
      <tr><th>Registration Number</th><td>{{ details.registration_number }}</td></tr>
      <tr><th>Registration Date</th><td>{{ details.registration_date }}</td></tr>
      <tr><th>CNR Number</th><td>{{ details.cnr_number }}</td></tr>
      <tr><th>First Hearing</th><td>{{ details.first_hearing }}</td></tr>
      <tr><th>Decision Date</th><td>{{ details.decision_date }}</td></tr>
      <tr><th>Status</th><td>{{ details.case_status }}</td></tr>
      <tr><th>Nature of Disposal</th><td>{{ details.nature_of_disposal }}</td></tr>
      <tr><th>Court & Judge</th><td>{{ details.judge }}</td></tr>
      <tr><th>Petitioners</th><td>{{ details.petitioners | join(', ') }}</td></tr>
      <tr><th>Respondents</th><td>{{ details.respondents | join(', ') }}</td></tr>
    </tbody>
  </table>

  <h5>Orders / Judicial Proceedings</h5>
  <table class="table table-bordered">
    <thead>
      <tr>
        <th>#</th>
        <th>Date</th>
        <th>Details</th>
        <th>Download</th>
      </tr>
    </thead>
    <tbody>
      {% for order in details.orders %}
      <tr>
        <td>{{ order.number }}</td>
        <td>{{ order.date }}</td>
        <td>{{ order.details }}</td>
        <td>
          <a href="{{ url_for('download_file', filename=order.pdf_link) }}" class="btn btn-sm btn-primary" download>Download PDF</a>
        </td>
      </tr>
      {% endfor %}
    </tbody>
  </table>

  <h5>Case History</h5>
  <table class="table table-bordered">
    <thead>
      <tr>
        <th>Entry</th>
        <th>Judge</th>
        <th>Business Date</th>
        <th>Hearing Date</th>
        <th>Purpose</th>
      </tr>
    </thead>
    <tbody>
      {% for h in details.histories %}
      <tr>
        <td>{{ h.entry }}</td>
        <td>{{ h.judge }}</td>
        <td>{{ h.business_date }}</td>
        <td>{{ h.hearing_date }}</td>
        <td>{{ h.purpose }}</td>
      </tr>
      {% endfor %}
    </tbody>
  </table>

  <h5>Applied Acts and Sections</h5>
  <table class="table table-bordered">
    <thead>
      <tr>
        <th>Act</th>
        <th>Section</th>
      </tr>
    </thead>
    <tbody>
      {% for act in details.acts %}
      <tr>
        <td>{{ act.act_name }}</td>
        <td>{{ act.section }}</td>
      </tr>
      {% endfor %}
    </tbody>
  </table>

  <a href="{{ url_for('index') }}" class="btn btn-primary mt-3">Start New Search</a>

  <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/js/bootstrap.bundle.min.js"></script>
</body>
</html>
